# Qt 番茄时钟 (Pomodoro Timer) - 增强版

一个功能完整的图形界面番茄时钟程序，基于 Qt 框架开发，支持多种实用功能。

## 🚀 主要功能

### 核心计时功能
- ⏰ **智能计时**：25分钟工作 + 5分钟休息（可自定义）
- 🔄 **自动切换**：工作结束后自动切换到休息，休息结束自动开始新周期
- ?? **系统提示音**：阶段结束时播放 macOS 系统提示音
- ⏯️ **灵活控制**：开始、暂停/继续、重置
- ??? **醒目提醒**：工作/休息阶段结束时显示弹窗并播放多次提示音

### 新增功能
#### 1. 自定义时间设置
- 点击"设置"按钮调整工作和休息时间
- 工作时间：1-120分钟（可配置）
- 休息时间：1-60分钟（可配置）

#### 2. 周期统计功能
- 实时显示已完成的番茄周期数量
- 自动保存统计信息

#### 3. 主题切换
- 支持深色/浅色主题切换
- 点击"深色主题"/"浅色主题"按钮切换
- 主题偏好自动保存

#### 4. 系统托盘支持
- 程序最小化到系统托盘
- 双击托盘图标显示/隐藏窗口
- 托盘右键菜单：显示窗口、隐藏窗口、退出
- **实时倒计时显示**：
  - **圆形进度指示**：托盘图标显示圆形进度条，直观展示时间进度
  - **分钟数显示**：图标中央实时显示当前剩余分钟数
  - **动态更新**：每秒更新图标显示，反映实时倒计时
- **智能提示**：悬浮提示显示完整时间信息（阶段 + 剩余时间）

#### 5. 加强的结束提醒（新增）
- **醒目弹窗提醒**：工作/休息结束时有明显的弹窗提示
- **多次提示音**：播放三次提示音，每次间隔500毫秒
- **自动居中显示**：弹窗自动在主屏幕中央弹出
- **强制置顶**：弹窗始终显示在最前面
- **淡入动画**：平滑的淡入效果增强视觉体验
- **工作完成祝贺**：显示完成的番茄钟数量，增强成就感
- **自定义消息**：工作结束显示周期统计，休息结束显示激励信息

#### 6. 可选自动锁屏功能（新增）
- **智能锁屏**：休息阶段开始时自动锁定屏幕
- **配置选项**：主界面复选框"休息时间自动锁屏"
- **安全保护**：防止工作时被干扰，强制进入休息状态
- **灵活配置**：可随时启用/禁用该功能
- **macOS专用**：使用CGSession命令实现系统锁屏
- **状态显示**：弹窗和托盘消息会显示锁屏状态

## 📱 界面说明

```
┌─────────────────────────────────────┐
│ 已完成周期: 0      [设置] [深色主题] │
│                                     │
│          工作阶段                  │
│           25:00                    │
│                                     │
│        [开始] [暂停] [重置]        │
└─────────────────────────────────────┘
```

## 🔧 安装和运行

### 编译方法
```bash
# 使用qmake生成Makefile
qmake qt_pomodoro.pro

# 编译程序
make

# 运行程序
./qt_pomodoro.app/Contents/MacOS/qt_pomodoro
```

### 快速运行
```bash
# 一键编译并运行
qmake && make && ./qt_pomodoro.app/Contents/MacOS/qt_pomodoro

# 或在Finder中双击 qt_pomodoro.app
```

## ⌨️ 快捷键
- **Esc**：隐藏窗口到系统托盘
- **双击托盘图标**：显示/隐藏窗口

## ⚙️ 配置存储
程序设置自动保存到系统配置文件中：
- **macOS**: `~/Library/Preferences/PomodoroApp/QtPomodoro.plist`

存储内容包括：
- 工作时间设置
- 休息时间设置  
- 已完成周期数
- 主题偏好

## 🎨 主题预览

### 浅色主题
![浅色主题界面]()

### 深色主题
![深色主题界面]()

## 🔄 使用流程

1. **启动程序**：双击应用或命令行启动
2. **开始计时**：点击"开始"按钮
3. **自定义设置**：点击"设置"调整时间
4. **暂停/继续**：点击"暂停"按钮暂停计时
5. **系统托盘**：关闭窗口时程序最小化到托盘继续运行
6. **完成工作**：通过托盘右键菜单退出程序

## 🛠️ 技术特性

- **跨平台**：基于 Qt 框架，支持 macOS/Windows/Linux
- **轻量级**：原生 C++ 开发，资源占用低
- **稳定性**：异常处理和状态保存
- **用户体验**：直观的界面设计和流畅的操作

## 📋 文件结构
```
qt_pomodoro/
├── qt_pomodoro.pro      # Qt 项目配置文件
├── main.cpp             # 主程序入口
├── mainwindow.h         # 主窗口头文件
├── mainwindow.cpp       # 主窗口实现
├── mainwindow.ui        # UI 设计文件
├── resources.qrc        # 资源文件
├── README_QT.md         # 说明文档
└── qt_pomodoro.app/     # 生成的应用程序
```

## 🐛 故障排除

### 编译问题
```bash
# 如果遇到依赖问题，确保 Qt 正确安装
brew info qt

# 清理重新编译
make clean
qmake && make
```

### 托盘图标不显示
- 检查系统托盘设置
- 确保程序有显示托盘图标的权限

### 声音不播放
- 确认系统音量正常
- 检查系统提示音设置

## 📞 支持

如需帮助或发现问题，请检查：
1. 确保系统满足 Qt 运行时要求
2. 查看终端输出信息
3. 删除配置文件重新生成：`rm ~/Library/Preferences/PomodoroApp/QtPomodoro.plist`

---

享受高效的番茄工作法！🍅⏰